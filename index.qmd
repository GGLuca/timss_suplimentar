---
title: "Analize suplimentare TIMSS"
format:
  html:
    code-fold: true
    toc: true
warning: false
echo: false
---

```{r}
library(tidyverse)
library(brms)
library(marginaleffects)
library(ggdist)
library(see)
library(gt)
library(MetBrewer)
library(sjPlot)
```

## Diferențele pe domenii/subdomenii

Există diferențe semnificative între scorurile obținute de elevii români, în funcție de domeniile și subdomeniile de conținut și/sau abilitățile cognitive la matematică? Dacă da, pe ce domenii se obțin scorurile medii cele mai mici?

### Domeniile de conținut

> Preluat din raportul de țară (2021), detalii [aici](https://unibuc.ro/wp-content/uploads/2021/06/TIMSS-Raport-de-tara-2021-05-07.pdf) (p.36)
>
> *Numere* este compus din: mulțimea numerelor întregi, fracții și fracții zecimale și rapoarte, proporții și procente. Elevilor li s-a cerut să efectueze calcule și să rezolve probleme care vizau conceptul de număr întreg și algoritmi sau operații procedurale legate de întregi, fracții și fracții zecimale.
>
> *Algebră* este compus din: expresii, operații și ecuații și relații și funcții. Elevilor li s-a cerut să rezolve situații din viața reală folosind modele algebrice și să explice relații care se refereau la concepte algebrice. De exemplu, elevii au primit probleme care se refereau la ecuații liniare și funcții, pentru a exprima cantități care se transformă proporțional (de exemplu, conceptul de pantă).
>
> *Geometrie*: Pe baza înțelegerii figurilor geometrice și a măsurilor (lungimi, arii, măsuri de unghiuri), elevilor li s-a cerut să analizeze proprietățile unor figuri și corpuri geometrice variate și să calculeze perimetre, arii și volume. Elevii au rezolvat probleme și au furnizat explicații și argumentări pe baza unor concepte și relații geometrice, precum congruența, asemănarea, teorema lui Pitagora etc.
>
> *Date și probabilități*, a fost compus din: organizarea datelor și probabilități. Elevilor li s-a cerut să „citească" și să extragă date relevante dintr-o varietate de forme de prezentare vizuală (tabele, grafice, diagrame), să facă prelucrări statistice de bază care țin cont de distribuția datelor, să organizeze și să reprezinte date pentru a putea răspunde la întrebări.

```{r}

fit2.2   <- readRDS("Date/fit1.1.rds")   # Obiect brmsfit 
tabel2   <- readRDS("Date/table1.2.rds") # Descriptiv 
pred2    <- readRDS("Date/pred.1.2.rds") # Predictiile modelului

## Recoding tabel$categorie
tabel2$categorie <- tabel2$categorie %>%
  fct_recode(
    "Numere" = "number",
    "Algebra" = "algebra",
    "Geometrie" = "geometry",
    "Probabilitati" = "chance"
  )

pred2 %>% 
ggplot(aes(x = draw, fill = factor(categorie))) +
       stat_halfeye(slab_alpha = .5) +
       labs(x = "Estimarea diferentelor intre medii",
            y = "Densitatea distributiei estimate")+
       scale_fill_brewer(name   =   "Categorie", 
                         labels = c("Numere",
                                    "Algebra",
                                    "Geometrie",
                                    "Probabilitati"),
                         palette = "Set1")+
      theme_radar(legend.position="bottom")

gt_tbl = tabel2 %>% 
  select(-c(rowid, type)) %>% 
 gt()

gt_tbl %>%
  tab_header(
    title = "Estimari ale diferentelor de grup"
  ) %>% 
  cols_label(
    predicted = html("Medie Estimata"),
    categorie = html("Domeniul Cognitiv"),
    conf.low = html("Prag inferior 95%"),
    conf.high = html("Prag superior 95%")
  )

```

Există difernțe notabile între domeniile de conținut cu perechea algebră - probabiliăți fiind poate cea mai evidentă, ceva mai mult de 30 de puncte.

### Domeniul cognitiv

> *Cunoaștere* se referă la informații, concepte și proceduri pe care elevii trebuie să le știe.

> *Aplicare* se referă la abilitatea elevilor de a aplica cunoștințele și conceptele matematice înțelese pentru a rezolva probleme sau pentru a răspunde la întrebări.

> *Raționament* conține itemi care evaluează abilitățile cognitive implicate în rezolvarea unor probleme nefamiliare, care se referă la situații complexe, la probleme care se rezolvă în mai mulți pași.

```{r}
fit1.1  <- readRDS("Date/fit1.1.rds")   # Obiect brmsfit 
tabel   <- readRDS("Date/table1.1.rds") # Descriptiv 
pred    <- readRDS("Date/pred.1.1.rds") # Predictiile pt grafic

## Recoding tabel$categorie
tabel$categorie <- tabel$categorie %>%
  fct_recode(
    "Aplicare" = "applying",
    "Cunoastere" = "knowing",
    "Rationament" = "reasoning"
  )

pred %>% 
ggplot(aes(x = draw, fill = factor(categorie))) +
       stat_halfeye(slab_alpha = .5) +
       labs(x = "Estimarea diferentelor intre medii",
            y = "Densitatea distributiei estimate")+
       scale_fill_brewer(name   =   "Categorie", 
                         labels = c("Aplicare",
                                    "Cunoastere",
                                    "Rationament"),
                         palette = "Set1")+
      theme_radar(legend.position="bottom")

gt_tbl = tabel %>% 
  select(-c(rowid, type)) %>% 
 gt()

gt_tbl %>%
  tab_header(
    title = "Estimari ale diferentelor de grup"
  ) %>% 
  cols_label(
    predicted = html("Medie Estimata"),
    categorie = html("Domeniul Cognitiv"),
    conf.low = html("Prag inferior 95%"),
    conf.high = html("Prag superior 95%")
  )

```

## Mediul de proveniență

Exista o diferenta semnificativa a scorurilor la matematica in functie de mediul de provenienta al elevului? In prezenta altor variabile de control, mediul de provenienta are sau isi pastreaza un efect ridicat? In cazul in care efectul mediului de provenienta e mare, se poate face o analiza mai detaliata a scorurilor elevilor din rural si urban mic (inclusiv pe domenii, subdomenii si abilitati cognitive) si a factorilor explicativi?

Da, diferențele sunt notabile. De exemplu, în figura de mai jos, după ce controlăm pentru o serie de factori (dar cel mai important ramane resursele financiare de care dispune familia) probabiliatea de a gasi un elev performant (peste 600 de puncte) in zonele rurale este de doar de câteva procente. Invers, un elev foarte bun va fi gasit in 70% din cazuri in categoriile combinate *urban+oras mediu*.

```{r}
#| fig.cap = "Probabilitatea mediului de provenienta stiind performanta elevului, tinand statutul socioeconomic constant."

provenienta_c  <- readRDS("Date/provenienta_c.rds")   # Obiect brmsfit
ce <- conditional_effects(provenienta_c, categorical = T)

plot(ce, plot = FALSE)[[2]] +
  scale_fill_manual(name ="Categorie",
                    values=met.brewer("Homer2", 5))+
  scale_color_manual(name ="Categorie",
                     values=met.brewer("Homer2", 5))+
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 0.7))+
  labs(
    x = "Scor matematica",
    y = "Probabilitate")+
  see::theme_radar()

```

Alftel spus, 

```{r}
plot_provenienta  <- readRDS("Date/big.rds")
plot_provenienta
```

Imaginea este aceeași pe tot setul de date și pe toate domeniile.

```{r}
#| fig-height: 15

plot_grid  <- readRDS("Date/plot_grid.rds")
plot_grid
```

## Model mai larg 

Ce factori/cumul de factori au efect important asupra scorului obținut de elevii români la matematică? Ne interesează mai ales factori privind predarea (tot ce e disponibil), profesorii de matematică (nivelul de formare profesională, vechimea, auto-eficacitatea etc.) respectiv elevii (mediul de proveniență -- rural-urban mic-urban mare, nivelul de autonomie, percepții privind profesor/predare și orice ai descoperit relevant).

Modelul construit arată în general că variabilele cele mai importante ramân în continuare autoeficitatea sau cele legate de contextul familial (i.e., Statutul socioeconomic). Variabilele de nivel superior (legate de profesor, sau contextul scolar) raman cu un efect redus sau nesemnificativ.

```{r}
m0  <- readRDS("Date/model0.rds")
m1  <- readRDS("Date/model1.rds")

tab_model(m0, m1, show.ci = FALSE)
```

```{r}
#| fig.cap = "SSE = Statut socioeconomic. Claritate = Perceptia claritatii cu care se preda matematica. Apreciere = Aprecierea matematicii. Afect = Afect pozitiv fata de matematica. Satisfactie = Satisfactia cu locul de munca, Accent = Accentul pus de scoala pe performanta scolara. Limitari = Predare limitata de nevoile elevilor. Devzoltare = Ore de dezvoltare profesionala in ultimul an"

plot_model(m1, show.values = TRUE, value.offset = .3, type = "std")+see::theme_radar()

```


## Context european

Există o diferență semnificativă între scorul mediu obținut la matematică de elevii de clasa a IV-a respectiv a VIII-a? Dacă da, care este mai mic și cât de mic e față de media europeană? (daca exista date)

[Raportul de țară pentru România](https://unibuc.ro/wp-content/uploads/2021/06/TIMSS-Raport-de-tara-2021-05-07.pdf) (p.8): În perioada 1995-2003, România a obținut scoruri la matematică în intervalul 472-475 puncte, urmând ca în anii 2007 și 2011 scorul să scadă la 461 (2007) și 458 (2011). În 2019, România a înregistrat o ușoară creștere ajungând la 479 puncte, fiind plasată în continuare sub media internațională TIMSS (500).

Scorul mediu obținut de elevii români la matematică (479) este foarte aproape de pragul Intermediate International Benchmark (corespunzător unui scor de 475), ceea ce ar putea fi considerat „o notă de trecere", dar care, în mod evident, este foarte departe de ceea ce ne-am dori. Scorul obținut este cel mai mare scor din cele șase participări la TIMSS de până acum, o revenire după căderea din 2007 și 2011. **Oricum, scorul este semnificativ sub media internațională: niciuna dintre țările europene participante nu a obținut un scor mai mic**. Dintre țările europene participante, cel mai mare scor este obținut de Irlanda. Scorul României este foarte aproape scorurile Franței și Noii Zeelande, care au introdus reforme în ultimii ani. Scorul României este aproape de scorul obținut de Bahrein (481), dar trebuie menționat faptul că, din 2011, creșterea Bahrainului a fost de 72 de puncte, iar a României de 21 de puncte. Ungaria a crescut din 2011 cu 12 puncte, dar de la 505 la 517, iar Lituania a crescut cu 18 puncte, de la 502 la 520.

În ceea ce privește distribuția performanței la matematică, aceasta este inegală: - Aproximativ 6% din elevii români reușesc să atingă criteriile de referință pentru performanță avansată (advanced benchmark - corespunzător unui scor de 625), spre deosebire de elevii din Anglia - 11%, Ungaria - 11%, Lituania - 10%; - Un sfert (25%) dintre elevii români ating criteriile pentru performanță înaltă (high benchmark - corespunzător unui scor de 550), spre deosebire de elevii din Anglia - 35%, Ungaria - 36%, Lituania - 37%; - Jumătate (52%) reușesc să se încadreze în criteriile intermediare (corespunzător unui scor de 475). Aceste rezultate ne plasează la coada primei jumătăți a clasamentului; - Un număr foarte mare de elevi (22%) nu reușesc să atingă nici măcar criteriile de bază de literație numerică (low benchmark- corespunzător unui scor de 400), spre deosebire de elevii din Anglia - 10%; Ungaria - 10%, Lituania - 7%. Chiar și multe din țările care se plasează mai jos din punct de vedere al poziției absolute în clasamentul din 2019 stau mai bine la capacitatea de a angaja intelectual toate straturile de elevi: nivelul de analfabetism numeric (procentul de eșec la criteriile de bază) este mai mic în Italia - 9% și în Franța - 12%. Totodată, la extreme, putem găsi 15% dintre elevi care au obținut un scor de sub 356 și cei 3% cu scorurile peste 650, aceștia constituind aproape o cincime din numărul total al elevilor români ale căror scoruri sunt atât de depărtate de medie încât este greu de crezut că sunt rezultate ale unui sistem de educație care oferă șanse egale și acces egal tuturor copiilor.

## Literație

In general ne preocupa si daca problemele de literatie sunt un factor explicativ important pentru nivelurile scazute de numeratie (daca exista date sau acces la date care sa urmareasca ambele domenii, gen PISA)

```{r}


```
